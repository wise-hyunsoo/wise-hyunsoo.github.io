# 2024-02-12
## 1. Introduction

### 1.1 Sequential decision making
#### 1.1.1 Problem definition
![Pasted image 20250211093756.png](attachments/Pasted%20image%2020250211093756.png)
![Pasted image 20250211093819.png](attachments/Pasted%20image%2020250211093819.png)
- Remark

$$
p_{S}(s_t|s_{t-1},a_{t-1})=\sum_{\lbrace o_t|s_t=U(s_{t-1},a_{t-1},o_t)\rbrace} p_{\text{env}}(o_t | a_{1:t-1}, o_{1:t-1})
$$
- Maximum expected utility (principle) and Optimal policy

![Pasted image 20250211093735.png](attachments/Pasted%20image%2020250211093735.png)
#### 1.1.2 Universal model
![Pasted image 20250211103219.png](attachments/Pasted%20image%2020250211103219.png)


`Lorem ipsum dolor sit amet`

:   Sed sagittis eleifend rutrum. Donec vitae suscipit est. Nullam tempus
    tellus non sem sollicitudin, quis rutrum leo facilisis.


- hidden state $z_t$ 혹은 world state
	- update는 non-determistic하게 $z_{t+1}=W(z_t,a_t,\epsilon_t^z)$ 
	
- agent는 potentially noisy 혹은 partial observation $o_{t+1}=O(z_{t+1},\epsilon_{t+1}^o)$ 를 보게 됨
	- $o_t$는 *perceptual aliasing*이 있을 수 있음
	
- agent의 state $s_t$ 는 environment의 믿음(추측)을 담고 있음. 따라서 belief state 라고 부르기도 함.
	- 내부의 믿음 state가 있기에 perceptual aliasing이 있는 상황에서 외부상황에 대한 추측으로 같은 observation $o$가 관측됐다 하더라도 내부 믿음 상황(agent의 내부 state $s_t$)에 따라 다른 판단(action)을 내릴 수 있게 됨.
	- $s_{t+1}=SU(s_t,a_t,o_{t+1})=U(s_{t+1|t},o_{t+1})=U(P(s_t,a_t),o_{t+1})$ 와 같은 식으로 내부 믿음이 update됨.
		- $SU$: state update function, $P$: prediction function, $U$: update function

- RL 방법론에 따라 agent가 외부 observation을 예측하려는 시도도 함
	- $\hat{o}_{t+1}=D(s_{t+1|t})$ 로 다음 observation을 추측하고 이를 decoder $D$로 모델링하고 이를 훈련에 활용하기도 한다고 함(아마도 Model-based RL에서 하는듯)
	- 참고로 model-based RL에서 모델은 외부환경 혹은 World에 대한 modeling을 말하는 듯
		- 그중 state transition or dynamics model $p_S(s'|s,a)$ 를 학습하는 방법론이 있는 듯

> [!NOTE]
>  [Quiet-STaR: Language Models Can Teach Themselves to Think Before Speaking](https://arxiv.org/abs/2403.09629)에서는 이러한 dynamics를 학습하는 듯. 논문에 따르면 `The sample complexity of learning the dynamics is less than the sample complexity of learning the policy.` 이라 한다.
